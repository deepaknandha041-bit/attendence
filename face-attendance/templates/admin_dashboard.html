{% extends "layout.html" %}

{% block title %}Admin Dashboard - Vision ATTD{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2.5rem;">
        <div>
            <h2 style="margin: 0;">System Intelligence</h2>
            <p style="color: var(--text-muted); margin: 0.25rem 0;">Real-time overview of database metrics</p>
        </div>
        <a href="{{ url_for('export_attendance') }}" class="btn"
            style="background: var(--accent); color: #000; border: none;">Export Dataset</a>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <span class="stat-value" style="color: var(--primary);">{{ user_count }}</span>
            <span class="stat-label">Registered Profiles</span>
        </div>
        <div class="stat-card">
            <span class="stat-value" style="color: var(--accent);">{{ attendance_count }}</span>
            <span class="stat-label">System Verifications</span>
        </div>
    </div>
</div>

<div class="card" style="margin-top: 2rem;">
    <h2 style="margin-bottom: 2rem;">User Identity Management</h2>
    <div style="overflow-x: auto;">
        <table>
            <thead>
                <tr>
                    <th>UID</th>
                    <th>Full Name</th>
                    <th>Created At</th>
                    <th style="text-align: right;">Operations</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td style="font-family: monospace; opacity: 0.7;">#{{ user.id }}</td>
                    <td style="font-weight: 600;">{{ user.name }}</td>
                    <td style="color: var(--text-muted);">{{ user.created_at.strftime('%b %d, %Y') }}</td>
                    <td style="text-align: right;">
                        <form action="{{ url_for('delete_user', user_id=user.id) }}" method="POST"
                            onsubmit="return confirm('Security Warning: Deleting user will purge all facial biometric data and history. Continue?')">
                            <button type="submit" class="btn"
                                style="padding: 0.4rem 1rem; background: rgba(255, 77, 77, 0.1); color: var(--error); border-color: rgba(255, 77, 77, 0.2); font-size: 0.8rem;">Purge
                                Data</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}